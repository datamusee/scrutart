<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="utf-8">
  <title>Test de connexion Fuseki</title>
</head>
<body>
  <h1>Connexion à Fuseki (via Basic Auth)</h1>
  <button onclick="testLogin()">Se connecter</button>
  <div id="result"></div>

  <script>
    async function testLogin() {
      const login = prompt("Nom d'utilisateur Fuseki :");
      const password = prompt("Mot de passe :");

      const headers = new Headers();
      headers.set('Authorization', 'Basic ' + btoa(login + ':' + password));
      headers.set('Content-Type', 'application/sparql-update');

      const sparqlUpdate = "INSERT DATA { GRAPH <http://example.org/test-login> { <http://test> <http://loggedIn> \"true\" } }";

      try {
        const response = await fetch('https://datamusee.r2.enst.fr/scrutartState/update', {
          method: 'POST',
          headers: headers,
          body: sparqlUpdate
        });

        const resultDiv = document.getElementById("result");

        if (response.ok) {
          resultDiv.innerHTML = "<p style='color:green;'>Connexion réussie !</p>";
        } else if (response.status === 401) {
          resultDiv.innerHTML = "<p style='color:red;'>Échec de la connexion : identifiants incorrects.</p>";
        } else {
          resultDiv.innerHTML = `<p style='color:red;'>Erreur HTTP ${response.status}</p>`;
        }

      } catch (error) {
        document.getElementById("result").innerHTML = `<p style='color:red;'>Erreur : ${error}</p>`;
      }
    }
  </script>
</body>
</html>
